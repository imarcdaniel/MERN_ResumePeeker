{"ast":null,"code":"import _regeneratorRuntime from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';var SignUpForm=/*#__PURE__*/function(_Component){_inherits(SignUpForm,_Component);var _super=_createSuper(SignUpForm);function SignUpForm(){var _this;_classCallCheck(this,SignUpForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={email:'',password:'',error:''};_this.handleChange=function(evt){var _this$setState;_this.setState((_this$setState={},_defineProperty(_this$setState,evt.target.name,evt.target.value),_defineProperty(_this$setState,\"error\",''),_this$setState));};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(evt){var fetchResponse,token,userDoc;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:evt.preventDefault();_context.prev=1;_context.next=4;return fetch('/api/users/login',{method:'POST',headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email:_this.state.email,password:_this.state.password})});case 4:fetchResponse=_context.sent;if(fetchResponse.ok){_context.next=7;break;}throw new Error('Fetch failed - Bad request');case 7:_context.next=9;return fetchResponse.json();case 9:token=_context.sent;// 3. decode fetch response: get jwt token from srv\nlocalStorage.setItem('token',token);// 4. Stick token into localStorage\nuserDoc=JSON.parse(atob(token.split('.')[1])).user;// 5. Decode the token + put user document into state\n_this.props.setUserInState(userDoc);_context.next=19;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](1);console.log(\"SignupForm error\",_context.t0);_this.setState({error:'Sign Up Failed - Try Again'});case 19:case\"end\":return _context.stop();}}},_callee,null,[[1,15]]);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(SignUpForm,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"form-container\",onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"form\",{autoComplete:\"off\"},/*#__PURE__*/React.createElement(\"label\",null,\"Email\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"email\",value:this.state.email,onChange:this.handleChange,required:true}),/*#__PURE__*/React.createElement(\"label\",null,\"Password\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",name:\"password\",value:this.state.password,onChange:this.handleChange,required:true}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"LOG IN\"))),/*#__PURE__*/React.createElement(\"p\",{className:\"error-message\"},\"\\xA0\",this.state.error));}}]);return SignUpForm;}(Component);export{SignUpForm as default};","map":{"version":3,"sources":["/home/ericmbc/GA/resumates/MERN_ResumePeeker/resumates/src/components/LoginForm/LoginForm.jsx"],"names":["React","Component","SignUpForm","state","email","password","error","handleChange","evt","setState","target","name","value","handleSubmit","preventDefault","fetch","method","headers","body","JSON","stringify","fetchResponse","ok","Error","json","token","localStorage","setItem","userDoc","parse","atob","split","user","props","setUserInState","console","log"],"mappings":"0qCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,C,GAEqBC,CAAAA,U,2UACnBC,K,CAAQ,CACNC,KAAK,CAAE,EADD,CAENC,QAAQ,CAAE,EAFJ,CAGNC,KAAK,CAAE,EAHD,C,OAMRC,Y,CAAe,SAACC,GAAD,CAAS,oBACtB,MAAKC,QAAL,mDACGD,GAAG,CAACE,MAAJ,CAAWC,IADd,CACqBH,GAAG,CAACE,MAAJ,CAAWE,KADhC,yCAES,EAFT,mBAID,C,OAEDC,Y,0FAAe,iBAAOL,GAAP,kJACbA,GAAG,CAACM,cAAJ,GADa,sCAKiBC,CAAAA,KAAK,CAAC,kBAAD,CAAqB,CACpDC,MAAM,CAAE,MAD4C,CAEpDC,OAAO,CAAE,CAAE,eAAgB,kBAAlB,CAF2C,CAGpDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CAAEhB,KAAK,CAAE,MAAKD,KAAL,CAAWC,KAApB,CAA2BC,QAAQ,CAAE,MAAKF,KAAL,CAAWE,QAAhD,CAAf,CAH8C,CAArB,CALtB,QAKLgB,aALK,kBAYNA,aAAa,CAACC,EAZR,8BAYkB,IAAIC,CAAAA,KAAJ,CAAU,4BAAV,CAZlB,8BAcOF,CAAAA,aAAa,CAACG,IAAd,EAdP,QAcPC,KAdO,eAc4B;AACvCC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BF,KAA9B,EAAuC;AAEjCG,OAjBK,CAiBKT,IAAI,CAACU,KAAL,CAAWC,IAAI,CAACL,KAAK,CAACM,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAD,CAAf,EAAsCC,IAjB3C,CAiBiD;AAC5D,MAAKC,KAAL,CAAWC,cAAX,CAA0BN,OAA1B,EAlBW,iFAqBXO,OAAO,CAACC,GAAR,CAAY,kBAAZ,cACA,MAAK3B,QAAL,CAAc,CAAEH,KAAK,CAAE,4BAAT,CAAd,EAtBW,qE,0HA0Bf,iBAAS,CACP,mBACE,4CACE,2BAAK,SAAS,CAAC,gBAAf,CAAgC,QAAQ,CAAE,KAAKO,YAA/C,eACE,4BAAM,YAAY,CAAC,KAAnB,eACE,yCADF,cAEE,6BAAO,IAAI,CAAC,MAAZ,CAAmB,IAAI,CAAC,OAAxB,CAAgC,KAAK,CAAE,KAAKV,KAAL,CAAWC,KAAlD,CAAyD,QAAQ,CAAE,KAAKG,YAAxE,CAAsF,QAAQ,KAA9F,EAFF,cAGE,4CAHF,cAIE,6BAAO,IAAI,CAAC,UAAZ,CAAuB,IAAI,CAAC,UAA5B,CAAuC,KAAK,CAAE,KAAKJ,KAAL,CAAWE,QAAzD,CAAmE,QAAQ,CAAE,KAAKE,YAAlF,CAAgG,QAAQ,KAAxG,EAJF,cAKE,8BAAQ,IAAI,CAAC,QAAb,WALF,CADF,CADF,cAUE,yBAAG,SAAS,CAAC,eAAb,SAAoC,KAAKJ,KAAL,CAAWG,KAA/C,CAVF,CADF,CAcD,C,wBAvDqCL,S,SAAnBC,U","sourcesContent":["import React, { Component } from 'react';\n\nexport default class SignUpForm extends Component {\n  state = {\n    email: '',\n    password: '',\n    error: ''\n  };\n\n  handleChange = (evt) => {\n    this.setState({\n      [evt.target.name]: evt.target.value,\n      error: ''\n    });\n  };\n\n  handleSubmit = async (evt) => {\n    evt.preventDefault();\n    try {\n\n      // 1. POST our new user info to the server\n      const fetchResponse = await fetch('/api/users/login', {\n        method: 'POST',\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email: this.state.email, password: this.state.password, })\n      })\n\n      // 2. Check \"fetchResponse.ok\". False means status code was 4xx from the server/controller action\n      if (!fetchResponse.ok) throw new Error('Fetch failed - Bad request')\n\n      let token = await fetchResponse.json() // 3. decode fetch response: get jwt token from srv\n      localStorage.setItem('token', token);  // 4. Stick token into localStorage\n\n      const userDoc = JSON.parse(atob(token.split('.')[1])).user; // 5. Decode the token + put user document into state\n      this.props.setUserInState(userDoc)\n\n    } catch (err) {\n      console.log(\"SignupForm error\", err)\n      this.setState({ error: 'Sign Up Failed - Try Again' });\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"form-container\" onSubmit={this.handleSubmit}>\n          <form autoComplete=\"off\" >\n            <label>Email</label>\n            <input type=\"text\" name=\"email\" value={this.state.email} onChange={this.handleChange} required />\n            <label>Password</label>\n            <input type=\"password\" name=\"password\" value={this.state.password} onChange={this.handleChange} required />\n            <button type=\"submit\">LOG IN</button>\n          </form>\n        </div>\n        <p className=\"error-message\">&nbsp;{this.state.error}</p>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}